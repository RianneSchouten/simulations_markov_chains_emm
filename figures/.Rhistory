plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
#pdf(file = "plot_1000_5_25.pdf",
#    width = 10,
#    height = 8)
plot
setEPS()
postscript("whatever.eps")
plot
dev.off()
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 5) %>%
filter(S == 25)
plot <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of true subgroup',
#subtitle = 'nreps = 10, N = 1000, T = 5, S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
#theme_bw() +
#theme_light() +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
#pdf(file = "plot_1000_5_25.pdf",
#    width = 10,
#    height = 8)
plot
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 2) %>%
filter(S == 25)
plot <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of true subgroup',
#subtitle = 'nreps = 10, N = 1000, T = 5, S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
#theme_bw() +
#theme_light() +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
#pdf(file = "plot_1000_5_25.pdf",
#    width = 10,
#    height = 8)
plot
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 2) %>%
filter(S == 5)
plot <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of true subgroup',
#subtitle = 'nreps = 10, N = 1000, T = 5, S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
#theme_bw() +
#theme_light() +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 2) %>%
filter(S == 5)
plot <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of true subgroup',
#subtitle = 'nreps = 10, N = 1000, T = 5, S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
#theme_bw() +
#theme_light() +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
#pdf(file = "plot_1000_5_25.pdf",
#    width = 10,
#    height = 8)
plot
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 5) %>%
filter(S == 5)
plot <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of true subgroup',
#subtitle = 'nreps = 10, N = 1000, T = 5, S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
#theme_bw() +
#theme_light() +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
#pdf(file = "plot_1000_5_25.pdf",
#    width = 10,
#    height = 8)
plot
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 5) %>%
filter(S == 25)
plot <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of true subgroup',
#subtitle = 'nreps = 10, N = 1000, T = 5, S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
#theme_bw() +
#theme_light() +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
#pdf(file = "plot_1000_5_25.pdf",
#    width = 10,
#    height = 8)
plot
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 5) %>%
filter(S == 5)
plot <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of true subgroup',
#subtitle = 'nreps = 10, N = 1000, T = 5, S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
#theme_bw() +
#theme_light() +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
#pdf(file = "plot_1000_5_25.pdf",
#    width = 10,
#    height = 8)
plot
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 5) %>%
filter(S == 25)
plot <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of true subgroup',
#subtitle = 'nreps = 10, N = 1000, T = 5, S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
#theme_bw() +
#theme_light() +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
#pdf(file = "plot_1000_5_25.pdf",
#    width = 10,
#    height = 8)
plot
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 25) %>%
filter(S == 25)
plot <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of true subgroup',
#subtitle = 'nreps = 10, N = 1000, T = 5, S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
#theme_bw() +
#theme_light() +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
#pdf(file = "plot_1000_5_25.pdf",
#    width = 10,
#    height = 8)
plot
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 5) %>%
filter(S == 25)
plot <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of true subgroup',
#subtitle = 'nreps = 10, N = 1000, T = 5, S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
#theme_bw() +
#theme_light() +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
#pdf(file = "plot_1000_5_25.pdf",
#    width = 10,
#    height = 8)
plot
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 5) %>%
filter(S == 5)
plot <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of true subgroup',
#subtitle = 'nreps = 10, N = 1000, T = 5, S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
#theme_bw() +
#theme_light() +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
#pdf(file = "plot_1000_5_25.pdf",
#    width = 10,
#    height = 8)
plot
library(ggplot2)
library(readxl)
library(tidyverse)
setwd("C:/Users/20200059/Documents/Github/simulations_beam_search_markov_chain/figures/")
data <- read_excel("../data_output/experiment_initialprobs_20200617_20nreps_[100, 1000]_[2, 5, 25]_[2, 5, 25]_[2, 5, 10, 25].xlsx")
head(data)
names(data)
long_data <- data %>%
rename(delta_tv = deltatv,
omega_tv = omegatv,
phi_wd = difll,
phi_kl = weighteddifll,
phi_bic = BICdif,
phi_arl = relativell,
phi_warl = weightedrll) %>%
pivot_longer(
cols = c('delta_tv', 'omega_tv', 'phi_wd', 'phi_kl', 'phi_bic', 'phi_arl', 'phi_warl'),
names_to = "measure",
values_to = "Rank") %>%
mutate(facet = case_when(distAyn == 0 & distPiyn == 0 ~ 'No difference',
distAyn == 1 & distPiyn == 0 ~ 'Difference in transition matrix A',
distAyn == 0 & distPiyn == 1 ~ 'Difference in initial probabilities pi',
distAyn == 1 & distPiyn == 1 ~ 'Difference in both A and pi')) %>%
mutate(facet = factor(facet, levels = c('No difference', 'Difference in transition matrix A',
'Difference in initial probabilities pi', 'Difference in both A and pi'))) %>%
mutate(measure = factor(measure, levels = c('phi_warl', 'phi_arl', 'phi_bic', 'phi_kl',
'phi_wd', 'omega_tv', 'delta_tv')))
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 25) %>%
filter(S == 25)
plot <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of the true subgroup',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot
setEPS()
postscript("plot_100_25_25.eps")
plot
dev.off()
setEPS(widht=14)
setEPS(width=14)
postscript("plot_100_25_25.eps")
plot
dev.off()
setEPS(width=14, heigth=14)
setEPS(width=14, heigth=14)
ggsave("plot_100_25_25_2.eps", width = 20, height = 20, units = "cm")
plot
ggsave("plot_100_25_25_2.eps", width = 20, height = 20, units = "cm")
plot2
# plot 2
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 5) %>%
filter(S == 5) %>%
filter((distAyn == 0 & distPiyn == 1)|(distAyn == 1 & distPiyn == 0))
plot2 <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of the true subgroup',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot2
ggsave("2plot_100_25_25_2.eps", width = 20, height = 20, units = "cm")
ggsave("3plot_100_25_25_2.eps", width = 20, height = 10, units = "cm")
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 25) %>%
filter(S == 25)
plot1 <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of the true subgroup',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot1
ggsave("plot_100_25_25.eps", width = 20, height = 20, units = "cm")
# plot 2
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 5) %>%
filter(S == 5) %>%
filter((distAyn == 0 & distPiyn == 1)|(distAyn == 1 & distPiyn == 0))
plot2 <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of the true subgroup',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot2
ggsave("plot_100_5_5.eps", width = 20, height = 10, units = "cm")
plot_data <- long_data %>%
filter(N == 100) %>%
filter(T == 25) %>%
filter(S == 25)
plot1 <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of the true subgroup for N = 100, T = 25 and S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot1
ggsave("plot_100_25_25.eps", width = 20, height = 20, units = "cm")
plot1 <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of the true subgroup; N = 100, T = 25 and S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot1
?plot.title
plot1 <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of the true subgroup; N = 100, T = 25 and S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank())
plot1
ggsave("plot_100_25_25.eps", width = 20, height = 20, units = "cm")
plot1 <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of the true subgroup; N = 100, T = 25 and S = 25',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank())
plot1
ggsave("plot_100_25_25.eps", width = 20, height = 20, units = "cm")
plot1 <- ggplot(plot_data, aes(y = Rank, x = measure)) +
geom_boxplot(aes(fill = as.factor(ncovs))) +
coord_flip() +
facet_wrap(facet~., ncol = 2) +
labs(title = 'Ranks of the true subgroup',
fill = 'ncovs') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
axis.title.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank())
plot1
ggsave("plot_100_25_25.eps", width = 20, height = 20, units = "cm")
