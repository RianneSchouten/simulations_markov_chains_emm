group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order =
100 * sum(subgroup_orders ==
value, na.rm = TRUE) / 25) %>%
ggplot(aes(x = true_subgroup_order, y = perc_true_order, fill = ncovs)) +
geom_bar(stat = "identity", position = position_dodge()) +
facet_grid(timepoints ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': percentage of simulations where the true subgroup order is found',
sep = " ", collapse = NULL)) +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs)
sel_measure = 'phibic'
plot_data <- long_data %>%
#filter(ncovs == 20) %>%
filter(N == 100) %>%
filter(measure == sel_measure)
plot_data %>%
filter(type == 'rank') %>%
ggplot(aes(y = value, x = true_subgroup_order)) +
geom_boxplot(aes(fill = ncovs)) +
facet_grid(timepoints ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': boxplots of the resultlist rank of the true subgroup',
sep = " ", collapse = NULL),
fill = 'ncovs') +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order =
100 * sum(subgroup_orders ==
value, na.rm = TRUE) / 25) %>%
ggplot(aes(x = true_subgroup_order, y = perc_true_order, fill = ncovs)) +
geom_bar(stat = "identity", position = position_dodge()) +
facet_grid(timepoints ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': percentage of simulations where the true subgroup order is found',
sep = " ", collapse = NULL)) +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
### Second type of simulations
data <- read_excel("../data_output/experiment_higherorders_20201113_25nreps_[100]_[50, 25, 10]_[10, 5]_[20, 10, 5].xlsx")
head(data)
levels(data$T)
unique(data$T)
length_new_column = 6 * 5 * 25 * 1 * 3 * 2 * 3
long_data <- data %>%
pivot_longer(
cols = names(data)[8:dim(data)[2]],
names_to = "measure",
values_to = "value") %>%
add_column(type = rep(c('rank', 'order'), length_new_column)) %>%
mutate(measure = gsub("_.*", "", measure)) %>%
mutate(subgroup_orders = as.factor(subgroup_orders)) %>%
mutate(states = factor(S)) %>%
mutate(timepoints = factor(T)) %>%
mutate(ncovs = factor(ncovs)) %>%
mutate(true_subgroup_order = fct_recode(subgroup_orders, "pi + 1"="0"))
levels(long_data$timepoints)
sel_measure = 'phibic'
plot_data <- long_data %>%
#filter(ncovs == 20) %>%
filter(N == 100) %>%
filter(measure == sel_measure)
levels(plot_data$timepoints)
plot_data %>%
filter(type == 'rank') %>%
ggplot(aes(y = value, x = true_subgroup_order)) +
geom_boxplot(aes(fill = ncovs)) +
facet_grid(timepoints ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': boxplots of the resultlist rank of the true subgroup',
sep = " ", collapse = NULL),
fill = 'ncovs') +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
library(ggplot2)
library(readxl)
library(plyr)
library(tidyverse)
library(RColorBrewer)
library(mice)
setwd("C:/Users/20200059/Documents/Github/simulations_beam_search_markov_chain/figures/")
### Second type of simulations
data <- read_excel("../data_output/experiment_higherorders_20201113_25nreps_[100]_[50, 25, 10]_[10, 5]_[20, 10, 5].xlsx")
head(data)
length_new_column = 6 * 5 * 25 * 1 * 3 * 2 * 3
long_data <- data %>%
pivot_longer(
cols = names(data)[8:dim(data)[2]],
names_to = "measure",
values_to = "value") %>%
add_column(type = rep(c('rank', 'order'), length_new_column)) %>%
mutate(measure = gsub("_.*", "", measure)) %>%
mutate(subgroup_orders = as.factor(subgroup_orders)) %>%
mutate(states = factor(S)) %>%
mutate(timepoints = factor(T)) %>%
mutate(ncovs = factor(ncovs)) %>%
mutate(true_subgroup_order = fct_recode(subgroup_orders, "pi + 1"="0"))
head(long_data)
sel_measure = 'phibic'
plot_data <- long_data %>%
#filter(ncovs == 20) %>%
filter(N == 100) %>%
filter(measure == sel_measure)
plot_data %>%
filter(type == 'rank') %>%
ggplot(aes(y = value, x = true_subgroup_order)) +
geom_boxplot(aes(fill = ncovs)) +
facet_grid(timepoints ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': boxplots of the resultlist rank of the true subgroup',
sep = " ", collapse = NULL),
fill = 'ncovs') +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order =
100 * sum(subgroup_orders ==
value, na.rm = TRUE) / 25) %>%
ggplot(aes(x = true_subgroup_order, y = perc_true_order, fill = ncovs)) +
geom_bar(stat = "identity", position = position_dodge()) +
facet_grid(timepoints ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': percentage of simulations where the true subgroup order is found',
sep = " ", collapse = NULL)) +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs)
# order data
levels(plot_data$states)
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order =
100 * sum(subgroup_orders ==
value, na.rm = TRUE) / 25) %>%
ggplot(aes(x = true_subgroup_order, y = perc_true_order, fill = ncovs)) +
geom_bar(stat = "identity", position = position_dodge()) +
facet_grid(timepoints ~ ., labeller = label_both) +
labs(title = paste(sel_measure,
': percentage of simulations where the true subgroup order is found',
sep = " ", collapse = NULL)) +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order =
100 * sum(subgroup_orders ==
value, na.rm = TRUE) / 25) %>%
ggplot(aes(x = true_subgroup_order, y = perc_true_order, fill = ncovs)) +
geom_bar(stat = "identity", position = position_dodge()) +
facet_grid(. ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': percentage of simulations where the true subgroup order is found',
sep = " ", collapse = NULL)) +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order =
100 * sum(subgroup_orders ==
value, na.rm = TRUE) / 25) %>%
ggplot(aes(x = true_subgroup_order, y = perc_true_order, fill = ncovs)) +
geom_bar(stat = "identity", position = position_dodge()) +
facet_grid(timepoints ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': percentage of simulations where the true subgroup order is found',
sep = " ", collapse = NULL)) +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
rlang::last_error()
rlang::last_trace()
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order =
100 * sum(subgroup_orders ==
value, na.rm = TRUE) / 25)
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs)
long_data <- data %>%
pivot_longer(
cols = names(data)[8:dim(data)[2]],
names_to = "measure",
values_to = "value") %>%
add_column(type = rep(c('rank', 'order'), length_new_column)) %>%
mutate(measure = gsub("_.*", "", measure)) %>%
mutate(subgroup_orders = as.factor(subgroup_orders)) %>%
mutate(states = factor(S)) %>%
mutate(timepoints = factor(T)) %>%
mutate(ncovs = factor(ncovs)) #%>%
head(long_data)
sel_measure = 'phibic'
plot_data <- long_data %>%
#filter(ncovs == 20) %>%
filter(N == 100) %>%
filter(measure == sel_measure)
sel_measure = 'phiaic'
plot_data <- long_data %>%
#filter(ncovs == 20) %>%
filter(N == 100) %>%
filter(measure == sel_measure)
plot_data %>%
filter(type == 'rank') %>%
ggplot(aes(y = value, x = true_subgroup_order)) +
geom_boxplot(aes(fill = ncovs)) +
facet_grid(timepoints ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': boxplots of the resultlist rank of the true subgroup',
sep = " ", collapse = NULL),
fill = 'ncovs') +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
long_data <- data %>%
pivot_longer(
cols = names(data)[8:dim(data)[2]],
names_to = "measure",
values_to = "value") %>%
add_column(type = rep(c('rank', 'order'), length_new_column)) %>%
mutate(measure = gsub("_.*", "", measure)) %>%
mutate(true_subgroup_order = as.factor(subgroup_orders)) %>%
mutate(states = factor(S)) %>%
mutate(timepoints = factor(T)) %>%
mutate(ncovs = factor(ncovs)) #%>%
long_data <- data %>%
pivot_longer(
cols = names(data)[8:dim(data)[2]],
names_to = "measure",
values_to = "value") %>%
add_column(type = rep(c('rank', 'order'), length_new_column)) %>%
mutate(measure = gsub("_.*", "", measure)) %>%
mutate(true_subgroup_order = as.factor(subgroup_orders)) %>%
mutate(states = factor(S)) %>%
mutate(timepoints = factor(T)) %>%
mutate(ncovs = factor(ncovs)) #%>%
long_data <- data %>%
pivot_longer(
cols = names(data)[8:dim(data)[2]],
names_to = "measure",
values_to = "value") %>%
add_column(type = rep(c('rank', 'order'), length_new_column)) %>%
mutate(measure = gsub("_.*", "", measure)) %>%
mutate(true_subgroup_order = as.factor(subgroup_orders)) %>%
mutate(states = factor(S)) %>%
mutate(timepoints = factor(T)) %>%
mutate(ncovs = factor(ncovs)) %>%
mutate(true_subgroup_order = fct_recode(true_subgroup_order, "pi + 1"="0"))
long_data <- data %>%
pivot_longer(
cols = names(data)[8:dim(data)[2]],
names_to = "measure",
values_to = "value") %>%
add_column(type = rep(c('rank', 'order'), length_new_column)) %>%
mutate(measure = gsub("_.*", "", measure)) %>%
mutate(true_subgroup_order = as.factor(subgroup_orders)) %>%
mutate(states = factor(S)) %>%
mutate(timepoints = factor(T)) %>%
mutate(ncovs = factor(ncovs)) #%>%
head(long_data)
sel_measure = 'phiaic'
plot_data <- long_data %>%
#filter(ncovs == 20) %>%
filter(N == 100) %>%
filter(measure == sel_measure)
plot_data %>%
filter(type == 'rank') %>%
ggplot(aes(y = value, x = true_subgroup_order)) +
geom_boxplot(aes(fill = ncovs)) +
facet_grid(timepoints ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': boxplots of the resultlist rank of the true subgroup',
sep = " ", collapse = NULL),
fill = 'ncovs') +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order =
100 * sum(subgroup_orders ==
value, na.rm = TRUE) / 25) %>%
ggplot(aes(x = true_subgroup_order, y = perc_true_order, fill = ncovs)) +
geom_bar(stat = "identity", position = position_dodge()) +
facet_grid(timepoints ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': percentage of simulations where the true subgroup order is found',
sep = " ", collapse = NULL)) +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs)
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order =
100 * sum(subgroup_orders ==
value, na.rm = TRUE) / 25)
sel_measure = 'phibic'
plot_data <- long_data %>%
#filter(ncovs == 20) %>%
filter(N == 100) %>%
filter(measure == sel_measure)
plot_data %>%
filter(type == 'rank') %>%
ggplot(aes(y = value, x = true_subgroup_order)) +
geom_boxplot(aes(fill = ncovs)) +
facet_grid(timepoints ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': boxplots of the resultlist rank of the true subgroup',
sep = " ", collapse = NULL),
fill = 'ncovs') +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order =
100 * sum(subgroup_orders ==
value, na.rm = TRUE) / 25) %>%
ggplot(aes(x = true_subgroup_order, y = perc_true_order, fill = ncovs)) +
geom_bar(stat = "identity", position = position_dodge()) +
facet_grid(timepoints ~ states, labeller = label_both) +
labs(title = paste(sel_measure,
': percentage of simulations where the true subgroup order is found',
sep = " ", collapse = NULL)) +
xlab('true subgroup order') +
ylab('') +
guides(fill = guide_legend(direction = "horizontal")) +
theme(legend.position="top",
legend.justification="right",
plot.title = element_text(vjust=-4),
legend.box.margin = margin(-1,0,0,0, "line"),
#axis.title.y = element_text(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank()) +
scale_fill_manual(values=c("#CC6666", "#9999CC", "#66CC99"))
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order =
100 * sum(subgroup_orders ==
value, na.rm = TRUE) / 25)
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs)
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order = count())
plot_data %>%
filter(type == 'order') %>%
group_by(true_subgroup_order, timepoints, states, ncovs) %>%
summarize(perc_true_order = n())
